// Be sure to set the :StorageClass: and :Provisioner: value in each assembly
// on the line before the include statement for this module. For example, to
// set the StorageClass value to "AWS EBS", add the following line to the
// assembly:
// :StorageClass: AWS EBS
// Module included in the following assemblies:
//
// * storage/persistent_storage/persistent-storage-aws.adoc
// * storage/container_storage_interface/persistent-storage-csi-aws-efs.adoc

:_content-type: PROCEDURE
[id="storage-create-storage-class_{context}"]
= Creating the {StorageClass} storage class

Storage classes are used to differentiate and delineate storage levels and
usages. By defining a storage class, users can obtain dynamically provisioned
persistent volumes.

ifeval::["{Provisioner}" == "efs.csi.aws.com"]
The _AWS EFS CSI Driver Operator_, after being installed, does not create a storage class by default. However, you can manually create the AWS EFS `StorageClass`.
endif::[]

.Procedure

To create the AWS EFS storage class from the web console, follow these steps:

. In the {product-title} console, click *Storage* -> *Storage Classes*.

. On the *StorageClasses* overview page, click *Create Storage Class*.

. On the *StorageClasses* create page, enter values as desired:

.. Enter a name to reference the storage class.

.. Enter an optional description.

.. Select the reclaim policy.

.. Select *`{Provisioner}`* from the *Provisioner* drop-down list.
+
ifeval::["{Provisioner}" == "kubernetes.io/aws-ebs"]
[NOTE]
====
To create the storage class with the equivalent CSI driver, select `{CsiDriver}` from the drop-down list. For more details, see _AWS Elastic Block Store CSI Driver Operator_.
====
endif::[]

.. Enter additional parameters for the storage class as desired.

. Click *Create*.

// Undefine {StorageClass} attribute, so that any mistakes are easily spotted
:!StorageClass:

To create the AWS EFS storage class from the CLI, follow these steps:

* Create a `StorageClass` as follows:
+
[source,yaml]
----
kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: efs-sc
provisioner: efs.csi.aws.com
parameters:
  provisioningMode: efs-ap <1>
  fileSystemId: fs-a5324911 <2>
  directoryPerms: "700" <3>
  gidRangeStart: "1000" <4>
  gidRangeEnd: "2000" <4>
  basePath: "/dynamic_provisioning" <5>
----
<1> `provisioningMode` must be `efs-ap` to enable dynamic provisioning.
<2> `fileSystemId` must be the ID of the EFS volume created manually above.
<3> `directoryPerms` is the default permission of the root directory of the volume. In this case, the volume is accessible only by the owner.
<4> `gidRangeStart` and `gidRangeEnd` set the range of POSIX Group IDs (GIDs) that are used to set the GID of the AWS access point. If not specified, the default range is 50000-7000000. Each provisioned volume, and thus AWS access point, is assigned a unique GID from this range.
<5> `basePath` is the directory on the EFS volume that is used to create dynamically provisioned volumes. In this case, a PV is provisioned as “/dynamic_provisioning/<random uuid>” on the EFS volume. Only the subdirectory is mounted to pods that use the PV.
+
[NOTE]
====
A cluster admin can create several `StorageClasses`, each using a different EFS volume.
====
